app.beginUndoGroup("Create Brand Comp");

// === 1. Composition settings ===
var compWidth = 1080;
var compHeight = 1920;
var compDuration = 30; // seconds
var compFps = 30;

var brandComp = app.project.items.addComp(
    "brand name", 
    compWidth, 
    compHeight, 
    1,             // pixel aspect ratio
    compDuration, 
    compFps
);

// === 2. Add a text layer ===
var textLayer = brandComp.layers.addText("Welcome to Brand");

// Text properties
var textProp = textLayer.property("Source Text");
var textDocument = textProp.value;
textDocument.fontSize = 120;
textDocument.fillColor = [1, 1, 1]; // white
textDocument.justification = ParagraphJustification.CENTER_JUSTIFY;
textProp.setValue(textDocument);

// Center text in comp
textLayer.property("Position").setValue([compWidth/2, compHeight/2]);

// Simple opacity fade-in animation
var opacityProp = textLayer.property("Transform").property("Opacity");
opacityProp.setValueAtTime(0, 0);
opacityProp.setValueAtTime(2, 100);

// === 3. Import logo using a variable path ===
var logoPath = "C:/Users/YourName/Desktop/logo.png";  // << set your logo file path here
var logoFile = new File(logoPath);

if (logoFile.exists) {
    // Import options
    var importOpts = new ImportOptions(logoFile);
    var logoItem = app.project.importFile(importOpts);

    // Add logo to comp
    var logoLayer = brandComp.layers.add(logoItem);

    // Resize if too large
    logoLayer.transform.scale.setValue([20, 20]);

    // Move to top-right corner
    var margin = 50;
    logoLayer.property("Position").setValue([compWidth - margin, margin]);
    logoLayer.moveToBeginning();
} else {
    alert("⚠️ Logo file not found at: " + logoPath);
}

app.endUndoGroup();